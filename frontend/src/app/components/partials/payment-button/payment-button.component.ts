import { HttpClient } from '@angular/common/http';
import { Component, Input, OnInit } from '@angular/core';
import { Router } from '@angular/router';
import { CartService } from 'src/app/services/cart.service';
import { OrderService } from 'src/app/services/order.service';
import { Order } from 'src/app/shared/models/Order';
interface Payment {
  name: string;
  code: string;
  image: string;
}

@Component({
  selector: 'payment-button',
  templateUrl: './payment-button.component.html',
  styleUrl: './payment-button.component.css'
})
export class PaymentButtonComponent implements OnInit  {
  @Input()
  order!: Order
payments: Payment[] | undefined;
selectedCity: Payment | undefined;
constructor(private orderService: OrderService, http: HttpClient, private router: Router,private cartService: CartService) {

}

ngOnInit(): void {
  this.payments = [
    { name: 'PromtPay', code: 'promptpay', image: 'https://play-lh.googleusercontent.com/UIdkgBTFEFYTbE-_hUnekG5Aq16au9J7C6RI5gnoAeEZV2zMC3XgOnjL-0aYdmyWk6k=s256-rw' },
    { name: 'Rabbit Line Pay', code: 'rabbit_linepay', image: 'data:image/png;base64,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'  },
    { name: 'True Wallet', code: 'truemoney_qr', image: 'https://cdn6.aptoide.com/imgs/c/e/b/cebf5ce73494140a71efee3eb1c26a28_icon.png?w=128'  },
];
}

async selectedPayment(payment:{name: string, code: string}) {
  try {
    const omiseResponse: any = await this.orderService.createSorce(this.order.totalPrice, payment.code);

    // Assuming placeOrder returns a Promise
    const responseData = await this.orderService.placeOrder({
      source: omiseResponse.id,
      checkout: this.order
    });
    window.location.href = responseData.redirectUrl;
    this.cartService.clearCart()
  } catch (error) {
    console.error(error);
  }
}
}
